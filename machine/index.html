
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tolga Dimlioglu, Yunfei Teng" name="author"/>
<link href="../ASDTL/comm/" rel="prev"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.1.3" name="generator"/>
<title>Environment - Direbuted Training Library</title>
<link href="../assets/stylesheets/main.c4a75a56.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#distributed-training-environment">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Direbuted Training Library" class="md-header__button md-logo" data-md-component="logo" href=".." title="Direbuted Training Library">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Direbuted Training Library
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Environment
            
          </span>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Direbuted Training Library" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Direbuted Training Library">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Direbuted Training Library
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Introduction
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Tutorials/materials/">
        Introduction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Tutorials/concurrency/">
        Concurrency
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          SDTL
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          SDTL
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../SDTL/codes/">
        Codes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../SDTL/readme/">
        ReadMe
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          ASDTL
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          ASDTL
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../ASDTL/architecture/">
        Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ASDTL/comm/">
        Commmunication
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Environment
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Environment
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#local-setup">
    Local Setup
  </a>
<nav aria-label="Local Setup" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-hardware-configuration">
    1. Hardware configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-software-environment">
    2. Software environment
  </a>
<nav aria-label="2. Software environment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-nvidia-driver">
    (1) NVIDIA driver
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-pytorch">
    (2) PyTorch
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#remote-connection">
    Remote Connection
  </a>
<nav aria-label="Remote Connection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-ssh-to-the-server">
    (1) SSH to the server
  </a>
<nav aria-label="(1) SSH to the server" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1a-create-new-user">
    (1.a) Create new user
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1b-password-free-login">
    (1.b) Password-free login
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-test-bandwidth-between-servers">
    (2) Test bandwidth between servers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-excecute-remote-command">
    (3) Excecute remote command
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#local-setup">
    Local Setup
  </a>
<nav aria-label="Local Setup" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-hardware-configuration">
    1. Hardware configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-software-environment">
    2. Software environment
  </a>
<nav aria-label="2. Software environment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-nvidia-driver">
    (1) NVIDIA driver
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-pytorch">
    (2) PyTorch
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#remote-connection">
    Remote Connection
  </a>
<nav aria-label="Remote Connection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-ssh-to-the-server">
    (1) SSH to the server
  </a>
<nav aria-label="(1) SSH to the server" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1a-create-new-user">
    (1.a) Create new user
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1b-password-free-login">
    (1.b) Password-free login
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-test-bandwidth-between-servers">
    (2) Test bandwidth between servers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-excecute-remote-command">
    (3) Excecute remote command
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="distributed-training-environment">Distributed Training Environment<a class="headerlink" href="#distributed-training-environment" title="Permanent link">¶</a></h1>
<h2 id="local-setup">Local Setup<a class="headerlink" href="#local-setup" title="Permanent link">¶</a></h2>
<p>On this webpage one should be able to find related information about both hardware and software setups for distriuted training.</p>
<div class="admonition info">
<p class="admonition-title">Limitation</p>
<p>In this tutorial we only consider training nodes equiped with NVIDIA GPUs.</p>
</div>
<h3 id="1-hardware-configuration">1. Hardware configuration<a class="headerlink" href="#1-hardware-configuration" title="Permanent link">¶</a></h3>
<p>The performance of hardware has a strong influence on the training speed as expected.</p>
<ol>
<li>
<p><strong>GPUs</strong> Make sure the remote servers have available Nvidia GPUs (GTX 1080, RTX 2080, RTX 3008, etc.). These computational processors are key to training the deep learning models faster.</p>
</li>
<li>
<p><strong>CPUs</strong> Type <code>head /proc/cpuinfo</code> to check CPU information. Though most computation cost should be given to GPUs, the performance of CPU (like the number of cores) has strong influence on some multi-processing tasks like loading the traning and testing data. Besides, the choice of number of workers for data loader depends on the number of CPU cores .</p>
</li>
<li>
<p><strong>Storage Device</strong> Check the information of the storage device where the training and testing data is stored. Usually solid-state drive (SSD) has much faster reading and loadind speed than hard disk drive (HDD).</p>
</li>
</ol>
<h3 id="2-software-environment">2. Software environment<a class="headerlink" href="#2-software-environment" title="Permanent link">¶</a></h3>
<p>To properly configure the software envirionment used for distributed training, the following steps are necessary to be done:</p>
<h4 id="1-nvidia-driver">(1) NVIDIA driver<a class="headerlink" href="#1-nvidia-driver" title="Permanent link">¶</a></h4>
<p>Depending on the CUDA version, the Nvidia driver has to be properly installed. Take a look at Nvidia website for <a href="https://docs.nvidia.com/deploy/cuda-compatibility/index.html">CUDA Compatibility</a>.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>apt<span class="w"> </span>search<span class="w"> </span>nvidia-driver<span class="w">              </span><span class="c1"># search resources to install Nvidia driver</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nvidia-driver-460<span class="w">    </span><span class="c1"># install latest version of Nvidia driver</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>sudo<span class="w"> </span>reboot<span class="w">                           </span><span class="c1"># reboot the computer</span>
</span></code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Usually, installing the latest version of NVIDIA driver is the best choice. The reason is that CUDA of higher versions are usually only supported by lastest NVIDIA driver.</p>
</div>
<p>After installation and rebooting, type the following commands in the terminal.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>nvidia-smi<span class="w">                 </span><span class="c1"># check current status of GPUs on the machine</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>watch<span class="w"> </span>-n0.1<span class="w"> </span>nvidia-smi<span class="w">     </span><span class="c1"># check status of GPUs on the machine for every 0.1 second</span>
</span></code></pre></div>
If the returned information looks like then the GPUs and NVIDAI driver work functionally.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>+-----------------------------------------------------------------------------+
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="p">|</span><span class="w"> </span>NVIDIA-SMI<span class="w"> </span><span class="m">460</span>.73.01<span class="w">    </span>Driver<span class="w"> </span>Version:<span class="w"> </span><span class="m">460</span>.73.01<span class="w">    </span>CUDA<span class="w"> </span>Version:<span class="w"> </span><span class="m">11</span>.2<span class="w">     </span><span class="p">|</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="p">|</span>-------------------------------+----------------------+----------------------+
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="p">|</span><span class="w"> </span>GPU<span class="w">  </span>Name<span class="w">        </span>Persistence-M<span class="p">|</span><span class="w"> </span>Bus-Id<span class="w">        </span>Disp.A<span class="w"> </span><span class="p">|</span><span class="w"> </span>Volatile<span class="w"> </span>Uncorr.<span class="w"> </span>ECC<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="p">|</span><span class="w"> </span>Fan<span class="w">  </span>Temp<span class="w">  </span>Perf<span class="w">  </span>Pwr:Usage/Cap<span class="p">|</span><span class="w">         </span>Memory-Usage<span class="w"> </span><span class="p">|</span><span class="w"> </span>GPU-Util<span class="w">  </span>Compute<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="p">|</span><span class="w">                               </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">               </span>MIG<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="p">|</span><span class="o">===============================</span>+<span class="o">======================</span>+<span class="o">======================</span><span class="p">|</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span>GeForce<span class="w"> </span>GTX<span class="w"> </span><span class="m">1080</span><span class="w">    </span>Off<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:09:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="p">|</span><span class="w"> </span><span class="m">27</span>%<span class="w">   </span>29C<span class="w">    </span>P8<span class="w">     </span>5W<span class="w"> </span>/<span class="w"> </span>180W<span class="w"> </span><span class="p">|</span><span class="w">      </span>2MiB<span class="w"> </span>/<span class="w">  </span>8119MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="p">|</span><span class="w">                               </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-11"><a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>+-------------------------------+----------------------+----------------------+
</span><span id="__span-2-12"><a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span>GeForce<span class="w"> </span>GTX<span class="w"> </span><span class="m">1080</span><span class="w">    </span>Off<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:0A:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-13"><a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="p">|</span><span class="w"> </span><span class="m">28</span>%<span class="w">   </span>28C<span class="w">    </span>P8<span class="w">     </span>6W<span class="w"> </span>/<span class="w"> </span>180W<span class="w"> </span><span class="p">|</span><span class="w">      </span>2MiB<span class="w"> </span>/<span class="w">  </span>8119MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-14"><a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="p">|</span><span class="w">                               </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-15"><a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>+-------------------------------+----------------------+----------------------+
</span><span id="__span-2-16"><a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">  </span>GeForce<span class="w"> </span>GTX<span class="w"> </span><span class="m">1080</span><span class="w">    </span>Off<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:41:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-17"><a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="p">|</span><span class="w"> </span><span class="m">28</span>%<span class="w">   </span>32C<span class="w">    </span>P8<span class="w">     </span>5W<span class="w"> </span>/<span class="w"> </span>180W<span class="w"> </span><span class="p">|</span><span class="w">      </span>2MiB<span class="w"> </span>/<span class="w">  </span>8119MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-18"><a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="p">|</span><span class="w">                               </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-19"><a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a>+-------------------------------+----------------------+----------------------+
</span><span id="__span-2-20"><a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="p">|</span><span class="w">   </span><span class="m">3</span><span class="w">  </span>GeForce<span class="w"> </span>GTX<span class="w"> </span><span class="m">1080</span><span class="w">    </span>Off<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">00000000</span>:42:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-21"><a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="p">|</span><span class="w"> </span><span class="m">28</span>%<span class="w">   </span>33C<span class="w">    </span>P8<span class="w">     </span>6W<span class="w"> </span>/<span class="w"> </span>180W<span class="w"> </span><span class="p">|</span><span class="w">     </span>17MiB<span class="w"> </span>/<span class="w">  </span>8117MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-22"><a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="p">|</span><span class="w">                               </span><span class="p">|</span><span class="w">                      </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-2-23"><a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a>+-------------------------------+----------------------+----------------------+
</span></code></pre></div></p>
<div class="admonition help">
<p class="admonition-title">Help</p>
<ol>
<li>On the top row of the table, if shows the both the versions of NVIDIA driver and CUDA library.</li>
<li>Besides the information of NVIDIA driver and CUDA library, the table also indicated the number of GPUs the operating system <em>could</em> recognize and the status of GPUs (e.g. temperature, memory, utility, etc.).</li>
<li>Usually we are cared about two columns: Memort-Usage and GPU-Util. If the memory consumption exceeds the capacity of current GPU the GPU will stop working directly. While if the value of GPU-Util remains freeezed then the GPU is not working as expected. </li>
<li>NVIDIA driver will be installed at the root repository so different users share the same driver.</li>
</ol>
</div>
<h4 id="2-pytorch">(2) PyTorch<a class="headerlink" href="#2-pytorch" title="Permanent link">¶</a></h4>
<p>Go to the official website of <a href="https://pytorch.org/">PyTorch</a> and install the corresponding PyTorch version.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol>
<li>CUDA library will be implicitly installed along with PyTorch.</li>
<li>PyTorch will be installed in each user's local home folder so different users will have their own PyTorch installed.</li>
</ol>
</div>
<h2 id="remote-connection">Remote Connection<a class="headerlink" href="#remote-connection" title="Permanent link">¶</a></h2>
<h3 id="1-ssh-to-the-server">(1) SSH to the server<a class="headerlink" href="#1-ssh-to-the-server" title="Permanent link">¶</a></h3>
<p>To do distributed training, we usually create and modify the codes on a local machine first and then talk with the GPU servers through <code>ssh</code>.
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="ssh.png"><img alt='"ssh to the server"' src="ssh.png"/></a></p>
<h4 id="1a-create-new-user">(1.a) Create new user<a class="headerlink" href="#1a-create-new-user" title="Permanent link">¶</a></h4>
<p>Use the following command to create a new user if necessary. Different users will usually share the same NVIDIA driver but different PyTorch versions.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>sudo<span class="w"> </span>adduser<span class="w"> </span><span class="o">[</span>username<span class="o">]</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>sudo<span class="w"> </span><span class="o">[</span>username<span class="o">]</span>
</span></code></pre></div></p>
<h4 id="1b-password-free-login">(1.b) Password-free login<a class="headerlink" href="#1b-password-free-login" title="Permanent link">¶</a></h4>
<p>On local machine, generage amn SSH key first
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>ssh-keygen
</span></code></pre></div>
Then copy the key to a destinate server
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>ssh-copy-id<span class="w"> </span>user@hostname.example.com
</span></code></pre></div>
After these two steps one should be able to directly login into the remote server without entering passwords. However, when logining from the server to the local machine a password is still needed, so if one would like to login from the servers back to the local machine without being asked for a password just repeat the same steps on the server side.</p>
<div class="admonition help">
<p class="admonition-title">Help</p>
<ol>
<li>Make sure the user name is consistent with the one on the local machine if one would like to login without typing in the username explicitly. This is helpful when there are multiple users on the same machine.</li>
<li>How to <code>ssh</code> a machine by customized name instead of server's ip address? On Ubuntu, do <code>vim /etc/hosts</code> in the terminal and add a new line like <code>[server_ip_address] [my_server]</code>. After refreshing one could direcly do <code>ssh [my_server]</code> to login into the remote server.</li>
</ol>
</div>
<h3 id="2-test-bandwidth-between-servers">(2) Test bandwidth between servers<a class="headerlink" href="#2-test-bandwidth-between-servers" title="Permanent link">¶</a></h3>
<p>Install <code>iperf</code> package which is included in most Linux distribution’s repositories.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>apt-get<span class="w"> </span>install<span class="w"> </span>iperf
</span></code></pre></div>
On the terminal of one server
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>iperf<span class="w"> </span>-s
</span></code></pre></div>
On the terminal of the other server
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>iperf<span class="w"> </span>-c<span class="w"> </span><span class="o">[</span>first_server_ip_address<span class="o">]</span>
</span></code></pre></div>
The returned results shoud look like
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>------------------------------------------------------------
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>Server<span class="w"> </span>listening<span class="w"> </span>on<span class="w"> </span>TCP<span class="w"> </span>port<span class="w"> </span><span class="m">5001</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>TCP<span class="w"> </span>window<span class="w"> </span>size:<span class="w">  </span><span class="m">128</span><span class="w"> </span>KByte<span class="w"> </span><span class="o">(</span>default<span class="o">)</span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>------------------------------------------------------------
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="o">[</span><span class="w">  </span><span class="m">4</span><span class="o">]</span><span class="w"> </span><span class="nb">local</span><span class="w"> </span><span class="m">128</span>.238.9.108<span class="w"> </span>port<span class="w"> </span><span class="m">5001</span><span class="w"> </span>connected<span class="w"> </span>with<span class="w"> </span><span class="m">128</span>.238.9.109<span class="w"> </span>port<span class="w"> </span><span class="m">42488</span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="o">[</span><span class="w"> </span>ID<span class="o">]</span><span class="w"> </span>Interval<span class="w">       </span>Transfer<span class="w">     </span>Bandwidth
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="o">[</span><span class="w">  </span><span class="m">4</span><span class="o">]</span><span class="w">  </span><span class="m">0</span>.0-10.0<span class="w"> </span>sec<span class="w">  </span><span class="m">6</span>.58<span class="w"> </span>GBytes<span class="w">  </span><span class="m">5</span>.65<span class="w"> </span>Gbits/sec
</span></code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Network bandwidth</p>
<p>The Bandwidth is indicated in <strong>Gbits/sec</strong> where <code>1 Byte = 8 bits</code>. The common Ethernet usually supports a bandwidth of <code>1 Gbits/sec</code> which might be too slow for distriuted training. In order to improve the performance for distributed training, a minimum bandwidth of <code>10 Gbits/sec</code> is necessary. That requires the upgrade of network cable, network switch and network interface controller. The data center might use InfiniBand directly which is much faster and more expensive as well.</p>
</div>
<h3 id="3-excecute-remote-command">(3) Excecute remote command<a class="headerlink" href="#3-excecute-remote-command" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>Execute remote command
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>ssh<span class="w"> </span><span class="o">[</span>my_server<span class="o">]</span><span class="w"> </span><span class="s1">'[command]'</span>
</span></code></pre></div>
For example, one might always do <code>ssh [my_server] 'pkill -9 python'</code> to kill all python processes on the remote server for distributed training in case the training pipeline breaks.</p>
</li>
<li>
<p>Run multiple commands
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>ssh<span class="w"> </span><span class="o">[</span>my_server<span class="o">]</span><span class="w"> </span><span class="s1">'[command1]; [command2]; [command3]'</span>
</span></code></pre></div></p>
</li>
</ul>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.efa0ade1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>